/* ThinPaned.c generated by valac 0.36.7, the Vala compiler
 * generated from ThinPaned.vala, do not modify */

/***
    Copyright (C) 2012-2013 Victor Eduardo <victoreduardm@gmal.com>

    This program or library is free software; you can redistribute it
    and/or modify it under the terms of the GNU Lesser General Public
    License as published by the Free Software Foundation; either
    version 3 of the License, or (at your option) any later version.

    This library is distributed in the hope that it will be useful,
    but WITHOUT ANY WARRANTY; without even the implied warranty of
    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU
    Lesser General Public License for more details.
 
    You should have received a copy of the GNU Lesser General
    Public License along with this library; if not, write to the
    Free Software Foundation, Inc., 51 Franklin Street, Fifth Floor,
    Boston, MA 02110-1301 USA.
***/

#include <glib.h>
#include <glib-object.h>
#include <gtk/gtk.h>
#include <gdk/gdk.h>
#include <cairo.h>
#include <stdlib.h>
#include <string.h>
#include <float.h>
#include <math.h>


#define GRANITE_WIDGETS_TYPE_THIN_PANED (granite_widgets_thin_paned_get_type ())
#define GRANITE_WIDGETS_THIN_PANED(obj) (G_TYPE_CHECK_INSTANCE_CAST ((obj), GRANITE_WIDGETS_TYPE_THIN_PANED, GraniteWidgetsThinPaned))
#define GRANITE_WIDGETS_THIN_PANED_CLASS(klass) (G_TYPE_CHECK_CLASS_CAST ((klass), GRANITE_WIDGETS_TYPE_THIN_PANED, GraniteWidgetsThinPanedClass))
#define GRANITE_WIDGETS_IS_THIN_PANED(obj) (G_TYPE_CHECK_INSTANCE_TYPE ((obj), GRANITE_WIDGETS_TYPE_THIN_PANED))
#define GRANITE_WIDGETS_IS_THIN_PANED_CLASS(klass) (G_TYPE_CHECK_CLASS_TYPE ((klass), GRANITE_WIDGETS_TYPE_THIN_PANED))
#define GRANITE_WIDGETS_THIN_PANED_GET_CLASS(obj) (G_TYPE_INSTANCE_GET_CLASS ((obj), GRANITE_WIDGETS_TYPE_THIN_PANED, GraniteWidgetsThinPanedClass))

typedef struct _GraniteWidgetsThinPaned GraniteWidgetsThinPaned;
typedef struct _GraniteWidgetsThinPanedClass GraniteWidgetsThinPanedClass;
typedef struct _GraniteWidgetsThinPanedPrivate GraniteWidgetsThinPanedPrivate;
#define _g_object_unref0(var) ((var == NULL) ? NULL : (var = (g_object_unref (var), NULL)))
#define _g_list_free0(var) ((var == NULL) ? NULL : (var = (g_list_free (var), NULL)))
#define _g_param_spec_unref0(var) ((var == NULL) ? NULL : (var = (g_param_spec_unref (var), NULL)))

struct _GraniteWidgetsThinPaned {
	GtkPaned parent_instance;
	GraniteWidgetsThinPanedPrivate * priv;
};

struct _GraniteWidgetsThinPanedClass {
	GtkPanedClass parent_class;
};

struct _GraniteWidgetsThinPanedPrivate {
	GdkWindow* overlay_handle;
	gboolean in_resize;
};


static gpointer granite_widgets_thin_paned_parent_class = NULL;

GType granite_widgets_thin_paned_get_type (void) G_GNUC_CONST;
#define GRANITE_WIDGETS_THIN_PANED_GET_PRIVATE(o) (G_TYPE_INSTANCE_GET_PRIVATE ((o), GRANITE_WIDGETS_TYPE_THIN_PANED, GraniteWidgetsThinPanedPrivate))
enum  {
	GRANITE_WIDGETS_THIN_PANED_0_PROPERTY
};
#define GRANITE_WIDGETS_THIN_PANED_STYLE_PROP_OVERLAY_HANDLE_SIZE "overlay-handle-size"
#define GRANITE_WIDGETS_THIN_PANED_DEFAULT_STYLESHEET "\n" \
"        GraniteWidgetsThinPaned { -GtkPaned-handle-size: 1px; }\n" \
"    "
#define GRANITE_WIDGETS_THIN_PANED_FALLBACK_STYLESHEET "\n" \
"        GraniteWidgetsThinPaned.sidebar-pane-separator {\n" \
"            background-color: alpha (#000, 0.3);\n" \
"            border-width: 0;\n" \
"        }\n" \
"    "
GraniteWidgetsThinPaned* granite_widgets_thin_paned_new (GtkOrientation orientation);
GraniteWidgetsThinPaned* granite_widgets_thin_paned_construct (GType object_type, GtkOrientation orientation);
GtkCssProvider* granite_widgets_utils_set_theming (GtkWidget* widget, const gchar* stylesheet, const gchar* class_name, gint priority);
GdkWindow* granite_widgets_thin_paned_get_overlay_handle_window (GraniteWidgetsThinPaned* self);
static void granite_widgets_thin_paned_real_realize (GtkWidget* base);
static void granite_widgets_thin_paned_update_overlay_handle (GraniteWidgetsThinPaned* self);
static void granite_widgets_thin_paned_real_unrealize (GtkWidget* base);
static void granite_widgets_thin_paned_real_map (GtkWidget* base);
static void granite_widgets_thin_paned_real_unmap (GtkWidget* base);
static gboolean granite_widgets_thin_paned_real_draw (GtkWidget* base, cairo_t* ctx);
#define GRANITE_STYLE_CLASS_THIN_PANE_SEPARATOR "sidebar-pane-separator"
static void granite_widgets_thin_paned_real_size_allocate (GtkWidget* base, GtkAllocation* allocation);
static void granite_widgets_thin_paned_real_state_flags_changed (GtkWidget* base, GtkStateFlags previous_state);
static gboolean granite_widgets_thin_paned_real_motion_notify_event (GtkWidget* base, GdkEventMotion* event);
gboolean granite_widgets_utils_is_left_to_right (GtkWidget* widget);
static gboolean granite_widgets_thin_paned_real_button_press_event (GtkWidget* base, GdkEventButton* event);
static gboolean granite_widgets_thin_paned_real_button_release_event (GtkWidget* base, GdkEventButton* event);
static gboolean granite_widgets_thin_paned_real_grab_broken_event (GtkWidget* base, GdkEventGrabBroken* event);
static void granite_widgets_thin_paned_finalize (GObject * obj);


GraniteWidgetsThinPaned* granite_widgets_thin_paned_construct (GType object_type, GtkOrientation orientation) {
	GraniteWidgetsThinPaned * self = NULL;
	GtkOrientation _tmp0_;
	GtkCssProvider* _tmp1_;
	GtkCssProvider* _tmp2_;
	GtkCssProvider* _tmp3_;
	GtkCssProvider* _tmp4_;
	self = (GraniteWidgetsThinPaned*) g_object_new (object_type, NULL);
	_tmp0_ = orientation;
	gtk_orientable_set_orientation ((GtkOrientable*) self, _tmp0_);
	_tmp1_ = granite_widgets_utils_set_theming ((GtkWidget*) self, GRANITE_WIDGETS_THIN_PANED_DEFAULT_STYLESHEET, NULL, GTK_STYLE_PROVIDER_PRIORITY_APPLICATION);
	_tmp2_ = _tmp1_;
	_g_object_unref0 (_tmp2_);
	_tmp3_ = granite_widgets_utils_set_theming ((GtkWidget*) self, GRANITE_WIDGETS_THIN_PANED_FALLBACK_STYLESHEET, NULL, GTK_STYLE_PROVIDER_PRIORITY_THEME);
	_tmp4_ = _tmp3_;
	_g_object_unref0 (_tmp4_);
	return self;
}


GraniteWidgetsThinPaned* granite_widgets_thin_paned_new (GtkOrientation orientation) {
	return granite_widgets_thin_paned_construct (GRANITE_WIDGETS_TYPE_THIN_PANED, orientation);
}


GdkWindow* granite_widgets_thin_paned_get_overlay_handle_window (GraniteWidgetsThinPaned* self) {
	GdkWindow* result = NULL;
	GdkWindow* _tmp0_;
	g_return_val_if_fail (self != NULL, NULL);
	_tmp0_ = self->priv->overlay_handle;
	result = _tmp0_;
	return result;
}


static void granite_widgets_thin_paned_real_realize (GtkWidget* base) {
	GraniteWidgetsThinPaned * self;
	GdkWindowAttr attributes = {0};
	GdkWindowAttributesType attributes_mask = 0;
	GdkWindow* _tmp0_;
	GdkWindowAttr _tmp1_;
	GdkWindow* _tmp2_;
	GdkWindow* _tmp3_;
	self = (GraniteWidgetsThinPaned*) base;
	GTK_WIDGET_CLASS (granite_widgets_thin_paned_parent_class)->realize ((GtkWidget*) G_TYPE_CHECK_INSTANCE_CAST (self, gtk_paned_get_type (), GtkPaned));
	memset (&attributes, 0, sizeof (GdkWindowAttr));
	attributes.window_type = GDK_WINDOW_CHILD;
	attributes.x = 0;
	attributes.y = 0;
	attributes.width = 0;
	attributes.height = 0;
	attributes.wclass = GDK_INPUT_ONLY;
	attributes.event_mask = (gint) (((((GDK_BUTTON_PRESS_MASK | GDK_BUTTON_RELEASE_MASK) | GDK_ENTER_NOTIFY_MASK) | GDK_LEAVE_NOTIFY_MASK) | GDK_POINTER_MOTION_MASK) | GDK_POINTER_MOTION_HINT_MASK);
	attributes_mask = (GDK_WA_X | GDK_WA_Y) | GDK_WA_CURSOR;
	_tmp0_ = gtk_widget_get_window ((GtkWidget*) self);
	_tmp1_ = attributes;
	_tmp2_ = gdk_window_new (_tmp0_, &_tmp1_, attributes_mask);
	_g_object_unref0 (self->priv->overlay_handle);
	self->priv->overlay_handle = _tmp2_;
	_tmp3_ = self->priv->overlay_handle;
	gdk_window_set_user_data (_tmp3_, (GObject*) self);
	granite_widgets_thin_paned_update_overlay_handle (self);
}


static gpointer _g_object_ref0 (gpointer self) {
	return self ? g_object_ref (self) : NULL;
}


static void granite_widgets_thin_paned_real_unrealize (GtkWidget* base) {
	GraniteWidgetsThinPaned * self;
	GdkWindow* _tmp0_;
	GdkWindow* _tmp1_;
	GdkWindow* _tmp2_;
	self = (GraniteWidgetsThinPaned*) base;
	GTK_WIDGET_CLASS (granite_widgets_thin_paned_parent_class)->unrealize ((GtkWidget*) G_TYPE_CHECK_INSTANCE_CAST (self, gtk_paned_get_type (), GtkPaned));
	_tmp0_ = self->priv->overlay_handle;
	gdk_window_set_user_data (_tmp0_, NULL);
	_tmp1_ = self->priv->overlay_handle;
	_tmp2_ = _g_object_ref0 (_tmp1_);
	gdk_window_destroy (_tmp2_);
	_g_object_unref0 (self->priv->overlay_handle);
	self->priv->overlay_handle = NULL;
}


static void granite_widgets_thin_paned_real_map (GtkWidget* base) {
	GraniteWidgetsThinPaned * self;
	GdkWindow* _tmp0_;
	self = (GraniteWidgetsThinPaned*) base;
	GTK_WIDGET_CLASS (granite_widgets_thin_paned_parent_class)->map ((GtkWidget*) G_TYPE_CHECK_INSTANCE_CAST (self, gtk_paned_get_type (), GtkPaned));
	_tmp0_ = self->priv->overlay_handle;
	gdk_window_show (_tmp0_);
}


static void granite_widgets_thin_paned_real_unmap (GtkWidget* base) {
	GraniteWidgetsThinPaned * self;
	GdkWindow* _tmp0_;
	self = (GraniteWidgetsThinPaned*) base;
	GTK_WIDGET_CLASS (granite_widgets_thin_paned_parent_class)->unmap ((GtkWidget*) G_TYPE_CHECK_INSTANCE_CAST (self, gtk_paned_get_type (), GtkPaned));
	_tmp0_ = self->priv->overlay_handle;
	gdk_window_hide (_tmp0_);
}


static gboolean granite_widgets_thin_paned_real_draw (GtkWidget* base, cairo_t* ctx) {
	GraniteWidgetsThinPaned * self;
	gboolean result = FALSE;
	cairo_t* _tmp0_;
	GdkWindow* _tmp1_;
	gboolean _tmp2_;
	GtkAllocation allocation = {0};
	GtkAllocation _tmp3_ = {0};
	GtkStyleContext* style_context = NULL;
	GtkStyleContext* _tmp4_;
	GtkStyleContext* _tmp5_;
	GtkStateFlags state = 0;
	GtkStyleContext* _tmp6_;
	GtkStateFlags _tmp7_;
	gboolean _tmp8_;
	gboolean _tmp9_;
	gboolean _tmp11_;
	gdouble width = 0.0;
	gdouble height = 0.0;
	GtkOrientation _tmp13_;
	GtkOrientation _tmp14_;
	cairo_t* _tmp19_;
	cairo_t* _tmp20_;
	GdkWindow* _tmp21_;
	GtkStyleContext* _tmp22_;
	cairo_t* _tmp23_;
	gdouble _tmp24_;
	gdouble _tmp25_;
	GtkStyleContext* _tmp26_;
	GtkStyleContext* _tmp27_;
	GtkStyleContext* _tmp28_;
	GtkStateFlags _tmp29_;
	GtkStyleContext* _tmp30_;
	cairo_t* _tmp31_;
	gdouble _tmp32_;
	gdouble _tmp33_;
	cairo_t* _tmp34_;
	GtkStyleContext* _tmp35_;
	self = (GraniteWidgetsThinPaned*) base;
	g_return_val_if_fail (ctx != NULL, FALSE);
	_tmp0_ = ctx;
	GTK_WIDGET_CLASS (granite_widgets_thin_paned_parent_class)->draw ((GtkWidget*) G_TYPE_CHECK_INSTANCE_CAST (self, gtk_paned_get_type (), GtkPaned), _tmp0_);
	_tmp1_ = self->priv->overlay_handle;
	_tmp2_ = gdk_window_is_visible (_tmp1_);
	if (!_tmp2_) {
		result = FALSE;
		return result;
	}
	gtk_widget_get_allocation ((GtkWidget*) self, &_tmp3_);
	allocation = _tmp3_;
	_tmp4_ = gtk_widget_get_style_context ((GtkWidget*) self);
	_tmp5_ = _g_object_ref0 (_tmp4_);
	style_context = _tmp5_;
	_tmp6_ = style_context;
	_tmp7_ = gtk_style_context_get_state (_tmp6_);
	state = _tmp7_;
	g_object_get ((GtkWidget*) self, "is-focus", &_tmp8_, NULL);
	_tmp9_ = _tmp8_;
	if (_tmp9_) {
		GtkStateFlags _tmp10_;
		_tmp10_ = state;
		state = _tmp10_ | GTK_STATE_FLAG_SELECTED;
	}
	_tmp11_ = self->priv->in_resize;
	if (_tmp11_) {
		GtkStateFlags _tmp12_;
		_tmp12_ = state;
		state = _tmp12_ | GTK_STATE_FLAG_PRELIGHT;
	}
	_tmp13_ = gtk_orientable_get_orientation ((GtkOrientable*) self);
	_tmp14_ = _tmp13_;
	if (_tmp14_ == GTK_ORIENTATION_HORIZONTAL) {
		GtkAllocation _tmp15_;
		gint _tmp16_;
		width = (gdouble) 1;
		_tmp15_ = allocation;
		_tmp16_ = _tmp15_.height;
		height = (gdouble) _tmp16_;
	} else {
		GtkAllocation _tmp17_;
		gint _tmp18_;
		_tmp17_ = allocation;
		_tmp18_ = _tmp17_.width;
		width = (gdouble) _tmp18_;
		height = (gdouble) 1;
	}
	_tmp19_ = ctx;
	cairo_save (_tmp19_);
	_tmp20_ = ctx;
	_tmp21_ = gtk_paned_get_handle_window ((GtkPaned*) self);
	gtk_cairo_transform_to_window (_tmp20_, (GtkWidget*) self, _tmp21_);
	_tmp22_ = style_context;
	_tmp23_ = ctx;
	_tmp24_ = width;
	_tmp25_ = height;
	gtk_render_background (_tmp22_, _tmp23_, (gdouble) 0, (gdouble) 0, _tmp24_, _tmp25_);
	_tmp26_ = style_context;
	gtk_style_context_save (_tmp26_);
	_tmp27_ = style_context;
	gtk_style_context_add_class (_tmp27_, GRANITE_STYLE_CLASS_THIN_PANE_SEPARATOR);
	_tmp28_ = style_context;
	_tmp29_ = state;
	gtk_style_context_set_state (_tmp28_, _tmp29_);
	_tmp30_ = style_context;
	_tmp31_ = ctx;
	_tmp32_ = width;
	_tmp33_ = height;
	gtk_render_background (_tmp30_, _tmp31_, (gdouble) 0, (gdouble) 0, _tmp32_, _tmp33_);
	_tmp34_ = ctx;
	cairo_restore (_tmp34_);
	_tmp35_ = style_context;
	gtk_style_context_restore (_tmp35_);
	result = FALSE;
	_g_object_unref0 (style_context);
	return result;
}


static void granite_widgets_thin_paned_real_size_allocate (GtkWidget* base, GtkAllocation* allocation) {
	GraniteWidgetsThinPaned * self;
	GtkAllocation _tmp0_;
	self = (GraniteWidgetsThinPaned*) base;
	g_return_if_fail (allocation != NULL);
	_tmp0_ = *allocation;
	GTK_WIDGET_CLASS (granite_widgets_thin_paned_parent_class)->size_allocate ((GtkWidget*) G_TYPE_CHECK_INSTANCE_CAST (self, gtk_paned_get_type (), GtkPaned), &_tmp0_);
	granite_widgets_thin_paned_update_overlay_handle (self);
}


static void granite_widgets_thin_paned_update_overlay_handle (GraniteWidgetsThinPaned* self) {
	gboolean _tmp0_ = FALSE;
	GdkWindow* _tmp1_;
	gint overlay_handle_x = 0;
	gint overlay_handle_y = 0;
	gint overlay_handle_width = 0;
	gint overlay_handle_height = 0;
	GdkWindow* default_handle = NULL;
	GdkWindow* _tmp3_;
	GdkWindow* _tmp4_;
	GdkWindow* _tmp5_;
	gint _tmp6_ = 0;
	gint _tmp7_ = 0;
	GdkWindow* _tmp8_;
	gint _tmp9_;
	GdkWindow* _tmp10_;
	gint _tmp11_;
	gint overlay_handle_size = 0;
	GtkOrientation _tmp12_;
	GtkOrientation _tmp13_;
	GdkWindow* _tmp22_;
	gint _tmp23_;
	gint _tmp24_;
	gint _tmp25_;
	gint _tmp26_;
	gboolean _tmp27_ = FALSE;
	gboolean _tmp28_;
	g_return_if_fail (self != NULL);
	_tmp1_ = self->priv->overlay_handle;
	if (_tmp1_ == NULL) {
		_tmp0_ = TRUE;
	} else {
		gboolean _tmp2_;
		_tmp2_ = gtk_widget_get_realized ((GtkWidget*) self);
		_tmp0_ = !_tmp2_;
	}
	if (_tmp0_) {
		return;
	}
	_tmp3_ = gtk_paned_get_handle_window ((GtkPaned*) self);
	_tmp4_ = _g_object_ref0 (_tmp3_);
	default_handle = _tmp4_;
	_tmp5_ = default_handle;
	gdk_window_get_position (_tmp5_, &_tmp6_, &_tmp7_);
	overlay_handle_x = _tmp6_;
	overlay_handle_y = _tmp7_;
	_tmp8_ = default_handle;
	_tmp9_ = gdk_window_get_width (_tmp8_);
	overlay_handle_width = _tmp9_;
	_tmp10_ = default_handle;
	_tmp11_ = gdk_window_get_height (_tmp10_);
	overlay_handle_height = _tmp11_;
	gtk_widget_style_get ((GtkWidget*) self, GRANITE_WIDGETS_THIN_PANED_STYLE_PROP_OVERLAY_HANDLE_SIZE, &overlay_handle_size, NULL);
	_tmp12_ = gtk_orientable_get_orientation ((GtkOrientable*) self);
	_tmp13_ = _tmp12_;
	if (_tmp13_ == GTK_ORIENTATION_HORIZONTAL) {
		gint _tmp14_;
		gint _tmp15_;
		gint _tmp16_;
		gint _tmp17_;
		_tmp14_ = overlay_handle_x;
		_tmp15_ = overlay_handle_size;
		overlay_handle_x = _tmp14_ - (_tmp15_ / 2);
		_tmp16_ = overlay_handle_width;
		_tmp17_ = overlay_handle_size;
		overlay_handle_width = _tmp16_ + _tmp17_;
	} else {
		gint _tmp18_;
		gint _tmp19_;
		gint _tmp20_;
		gint _tmp21_;
		_tmp18_ = overlay_handle_y;
		_tmp19_ = overlay_handle_size;
		overlay_handle_y = _tmp18_ - (_tmp19_ / 2);
		_tmp20_ = overlay_handle_height;
		_tmp21_ = overlay_handle_size;
		overlay_handle_height = _tmp20_ + _tmp21_;
	}
	_tmp22_ = self->priv->overlay_handle;
	_tmp23_ = overlay_handle_x;
	_tmp24_ = overlay_handle_y;
	_tmp25_ = overlay_handle_width;
	_tmp26_ = overlay_handle_height;
	gdk_window_move_resize (_tmp22_, _tmp23_, _tmp24_, _tmp25_, _tmp26_);
	g_signal_emit_by_name ((GtkWidget*) self, "state-flags-changed", 0);
	_tmp28_ = gtk_widget_get_mapped ((GtkWidget*) self);
	if (_tmp28_) {
		GdkWindow* _tmp29_;
		gboolean _tmp30_;
		_tmp29_ = default_handle;
		_tmp30_ = gdk_window_is_visible (_tmp29_);
		_tmp27_ = _tmp30_;
	} else {
		_tmp27_ = FALSE;
	}
	if (_tmp27_) {
		GdkWindow* _tmp31_;
		_tmp31_ = self->priv->overlay_handle;
		gdk_window_show (_tmp31_);
	} else {
		GdkWindow* _tmp32_;
		_tmp32_ = self->priv->overlay_handle;
		gdk_window_hide (_tmp32_);
	}
	_g_object_unref0 (default_handle);
}


static void granite_widgets_thin_paned_real_state_flags_changed (GtkWidget* base, GtkStateFlags previous_state) {
	GraniteWidgetsThinPaned * self;
	GtkStateFlags _tmp0_;
	gboolean _tmp1_;
	self = (GraniteWidgetsThinPaned*) base;
	_tmp0_ = previous_state;
	GTK_WIDGET_CLASS (granite_widgets_thin_paned_parent_class)->state_flags_changed ((GtkWidget*) G_TYPE_CHECK_INSTANCE_CAST (self, gtk_paned_get_type (), GtkPaned), _tmp0_);
	_tmp1_ = gtk_widget_get_realized ((GtkWidget*) self);
	if (_tmp1_) {
		GdkCursor* default_handle_cursor = NULL;
		GdkWindow* _tmp2_;
		GdkCursor* _tmp3_;
		GdkCursor* _tmp4_;
		GdkWindow* _tmp5_;
		GdkCursor* _tmp6_;
		GdkCursor* _tmp7_;
		_tmp2_ = gtk_paned_get_handle_window ((GtkPaned*) self);
		_tmp3_ = gdk_window_get_cursor (_tmp2_);
		_tmp4_ = _g_object_ref0 (_tmp3_);
		default_handle_cursor = _tmp4_;
		_tmp5_ = self->priv->overlay_handle;
		_tmp6_ = gdk_window_get_cursor (_tmp5_);
		_tmp7_ = default_handle_cursor;
		if (_tmp6_ != _tmp7_) {
			GdkWindow* _tmp8_;
			GdkCursor* _tmp9_;
			_tmp8_ = self->priv->overlay_handle;
			_tmp9_ = default_handle_cursor;
			gdk_window_set_cursor (_tmp8_, _tmp9_);
		}
		_g_object_unref0 (default_handle_cursor);
	}
}


static gboolean granite_widgets_thin_paned_real_motion_notify_event (GtkWidget* base, GdkEventMotion* event) {
	GraniteWidgetsThinPaned * self;
	gboolean result = FALSE;
	gboolean _tmp0_;
	GdkDevice* _tmp3_ = NULL;
	GdkEventMotion* _tmp4_;
	GdkDevice* _tmp5_;
	GdkDevice* device = NULL;
	GdkDevice* _tmp7_;
	GdkDevice* _tmp8_;
	GdkDevice* _tmp21_;
	self = (GraniteWidgetsThinPaned*) base;
	g_return_val_if_fail (event != NULL, FALSE);
	_tmp0_ = self->priv->in_resize;
	if (!_tmp0_) {
		GdkEventMotion* _tmp1_;
		gboolean _tmp2_;
		_tmp1_ = event;
		_tmp2_ = GTK_WIDGET_CLASS (granite_widgets_thin_paned_parent_class)->motion_notify_event ((GtkWidget*) G_TYPE_CHECK_INSTANCE_CAST (self, gtk_paned_get_type (), GtkPaned), _tmp1_);
		result = _tmp2_;
		return result;
	}
	_tmp4_ = event;
	_tmp5_ = _tmp4_->device;
	_tmp3_ = _tmp5_;
	if (_tmp3_ == NULL) {
		GdkDevice* _tmp6_;
		_tmp6_ = gtk_get_current_event_device ();
		_tmp3_ = _tmp6_;
	}
	_tmp7_ = _g_object_ref0 (_tmp3_);
	device = _tmp7_;
	_tmp8_ = device;
	if (_tmp8_ == NULL) {
		GdkDisplay* display = NULL;
		GdkDisplay* _tmp9_;
		GdkDisplay* _tmp10_;
		GdkDisplay* _tmp11_;
		_tmp9_ = gtk_widget_get_display ((GtkWidget*) self);
		_tmp10_ = _g_object_ref0 (_tmp9_);
		display = _tmp10_;
		_tmp11_ = display;
		if (_tmp11_ != NULL) {
			GdkDeviceManager* dev_manager = NULL;
			GdkDisplay* _tmp12_;
			GdkDeviceManager* _tmp13_;
			GdkDeviceManager* _tmp14_;
			GdkDeviceManager* _tmp15_;
			_tmp12_ = display;
			_tmp13_ = gdk_display_get_device_manager (_tmp12_);
			_tmp14_ = _g_object_ref0 (_tmp13_);
			dev_manager = _tmp14_;
			_tmp15_ = dev_manager;
			if (_tmp15_ != NULL) {
				GdkDeviceManager* _tmp16_;
				GList* _tmp17_;
				GList* _tmp18_;
				gconstpointer _tmp19_;
				GdkDevice* _tmp20_;
				_tmp16_ = dev_manager;
				_tmp17_ = gdk_device_manager_list_devices (_tmp16_, GDK_DEVICE_TYPE_MASTER);
				_tmp18_ = _tmp17_;
				_tmp19_ = g_list_nth_data (_tmp18_, (guint) 0);
				_tmp20_ = _g_object_ref0 ((GdkDevice*) _tmp19_);
				_g_object_unref0 (device);
				device = _tmp20_;
				_g_list_free0 (_tmp18_);
			}
			_g_object_unref0 (dev_manager);
		}
		_g_object_unref0 (display);
	}
	_tmp21_ = device;
	if (_tmp21_ != NULL) {
		gint x = 0;
		gint y = 0;
		gint pos = 0;
		GdkWindow* _tmp22_;
		GdkDevice* _tmp23_;
		gint _tmp24_ = 0;
		gint _tmp25_ = 0;
		GtkAllocation allocation = {0};
		GtkAllocation _tmp26_ = {0};
		GtkOrientation _tmp27_;
		GtkOrientation _tmp28_;
		gint _tmp40_;
		gint _tmp41_;
		gint _tmp42_;
		gint _tmp43_;
		gint _tmp44_;
		gint _tmp45_;
		pos = 0;
		_tmp22_ = gtk_widget_get_window ((GtkWidget*) self);
		_tmp23_ = device;
		gdk_window_get_device_position (_tmp22_, _tmp23_, &_tmp24_, &_tmp25_, NULL);
		x = _tmp24_;
		y = _tmp25_;
		gtk_widget_get_allocation ((GtkWidget*) self, &_tmp26_);
		allocation = _tmp26_;
		_tmp27_ = gtk_orientable_get_orientation ((GtkOrientable*) self);
		_tmp28_ = _tmp27_;
		if (_tmp28_ == GTK_ORIENTATION_HORIZONTAL) {
			gint _tmp29_;
			GtkAllocation _tmp30_;
			gint _tmp31_;
			gint _tmp32_ = 0;
			gboolean _tmp33_;
			_tmp29_ = x;
			_tmp30_ = allocation;
			_tmp31_ = _tmp30_.x;
			x = _tmp29_ - _tmp31_;
			_tmp33_ = granite_widgets_utils_is_left_to_right ((GtkWidget*) self);
			if (_tmp33_) {
				gint _tmp34_;
				_tmp34_ = x;
				_tmp32_ = _tmp34_;
			} else {
				gint _tmp35_;
				gint _tmp36_;
				_tmp35_ = gtk_widget_get_allocated_width ((GtkWidget*) self);
				_tmp36_ = x;
				_tmp32_ = _tmp35_ - _tmp36_;
			}
			pos = _tmp32_;
		} else {
			gint _tmp37_;
			GtkAllocation _tmp38_;
			gint _tmp39_;
			_tmp37_ = y;
			_tmp38_ = allocation;
			_tmp39_ = _tmp38_.y;
			pos = _tmp37_ - _tmp39_;
		}
		_tmp40_ = pos;
		g_object_get ((GtkPaned*) self, "min-position", &_tmp41_, NULL);
		_tmp42_ = _tmp41_;
		g_object_get ((GtkPaned*) self, "max-position", &_tmp43_, NULL);
		_tmp44_ = _tmp43_;
		_tmp45_ = CLAMP (_tmp40_, _tmp42_, _tmp44_);
		gtk_paned_set_position ((GtkPaned*) self, _tmp45_);
		result = TRUE;
		_g_object_unref0 (device);
		return result;
	}
	g_return_val_if_reached (FALSE);
	_g_object_unref0 (device);
}


static gboolean granite_widgets_thin_paned_real_button_press_event (GtkWidget* base, GdkEventButton* event) {
	GraniteWidgetsThinPaned * self;
	gboolean result = FALSE;
	gboolean _tmp0_ = FALSE;
	gboolean _tmp1_ = FALSE;
	gboolean _tmp2_;
	GdkEventButton* _tmp8_;
	gboolean _tmp9_;
	self = (GraniteWidgetsThinPaned*) base;
	g_return_val_if_fail (event != NULL, FALSE);
	_tmp2_ = self->priv->in_resize;
	if (!_tmp2_) {
		GdkEventButton* _tmp3_;
		guint _tmp4_;
		_tmp3_ = event;
		_tmp4_ = _tmp3_->button;
		_tmp1_ = _tmp4_ == ((guint) GDK_BUTTON_PRIMARY);
	} else {
		_tmp1_ = FALSE;
	}
	if (_tmp1_) {
		GdkEventButton* _tmp5_;
		GdkWindow* _tmp6_;
		GdkWindow* _tmp7_;
		_tmp5_ = event;
		_tmp6_ = _tmp5_->window;
		_tmp7_ = self->priv->overlay_handle;
		_tmp0_ = _tmp6_ == _tmp7_;
	} else {
		_tmp0_ = FALSE;
	}
	if (_tmp0_) {
		self->priv->in_resize = TRUE;
		gtk_grab_add ((GtkWidget*) self);
		result = TRUE;
		return result;
	}
	_tmp8_ = event;
	_tmp9_ = GTK_WIDGET_CLASS (granite_widgets_thin_paned_parent_class)->button_press_event ((GtkWidget*) G_TYPE_CHECK_INSTANCE_CAST (self, gtk_paned_get_type (), GtkPaned), _tmp8_);
	result = _tmp9_;
	return result;
}


static gboolean granite_widgets_thin_paned_real_button_release_event (GtkWidget* base, GdkEventButton* event) {
	GraniteWidgetsThinPaned * self;
	gboolean result = FALSE;
	GdkEventButton* _tmp0_;
	GdkWindow* _tmp1_;
	GdkWindow* _tmp2_;
	GdkEventButton* _tmp3_;
	gboolean _tmp4_;
	self = (GraniteWidgetsThinPaned*) base;
	g_return_val_if_fail (event != NULL, FALSE);
	_tmp0_ = event;
	_tmp1_ = _tmp0_->window;
	_tmp2_ = self->priv->overlay_handle;
	if (_tmp1_ == _tmp2_) {
		self->priv->in_resize = FALSE;
		gtk_grab_remove ((GtkWidget*) self);
		result = TRUE;
		return result;
	}
	_tmp3_ = event;
	_tmp4_ = GTK_WIDGET_CLASS (granite_widgets_thin_paned_parent_class)->button_release_event ((GtkWidget*) G_TYPE_CHECK_INSTANCE_CAST (self, gtk_paned_get_type (), GtkPaned), _tmp3_);
	result = _tmp4_;
	return result;
}


static gboolean granite_widgets_thin_paned_real_grab_broken_event (GtkWidget* base, GdkEventGrabBroken* event) {
	GraniteWidgetsThinPaned * self;
	gboolean result = FALSE;
	GdkEventGrabBroken* _tmp0_;
	gboolean _tmp1_;
	self = (GraniteWidgetsThinPaned*) base;
	g_return_val_if_fail (event != NULL, FALSE);
	self->priv->in_resize = FALSE;
	_tmp0_ = event;
	_tmp1_ = GTK_WIDGET_CLASS (granite_widgets_thin_paned_parent_class)->grab_broken_event ((GtkWidget*) G_TYPE_CHECK_INSTANCE_CAST (self, gtk_paned_get_type (), GtkPaned), _tmp0_);
	result = _tmp1_;
	return result;
}


static void granite_widgets_thin_paned_class_init (GraniteWidgetsThinPanedClass * klass) {
	GParamSpecInt* _tmp0_;
	GParamSpecInt* _tmp1_;
	granite_widgets_thin_paned_parent_class = g_type_class_peek_parent (klass);
	g_type_class_add_private (klass, sizeof (GraniteWidgetsThinPanedPrivate));
	((GtkWidgetClass *) klass)->realize = (void (*) (GtkWidget *)) granite_widgets_thin_paned_real_realize;
	((GtkWidgetClass *) klass)->unrealize = (void (*) (GtkWidget *)) granite_widgets_thin_paned_real_unrealize;
	((GtkWidgetClass *) klass)->map = (void (*) (GtkWidget *)) granite_widgets_thin_paned_real_map;
	((GtkWidgetClass *) klass)->unmap = (void (*) (GtkWidget *)) granite_widgets_thin_paned_real_unmap;
	((GtkWidgetClass *) klass)->draw = (gboolean (*) (GtkWidget *, cairo_t*)) granite_widgets_thin_paned_real_draw;
	((GtkWidgetClass *) klass)->size_allocate = (void (*) (GtkWidget *, GtkAllocation*)) granite_widgets_thin_paned_real_size_allocate;
	((GtkWidgetClass *) klass)->state_flags_changed = (void (*) (GtkWidget *, GtkStateFlags)) granite_widgets_thin_paned_real_state_flags_changed;
	((GtkWidgetClass *) klass)->motion_notify_event = (gboolean (*) (GtkWidget *, GdkEventMotion*)) granite_widgets_thin_paned_real_motion_notify_event;
	((GtkWidgetClass *) klass)->button_press_event = (gboolean (*) (GtkWidget *, GdkEventButton*)) granite_widgets_thin_paned_real_button_press_event;
	((GtkWidgetClass *) klass)->button_release_event = (gboolean (*) (GtkWidget *, GdkEventButton*)) granite_widgets_thin_paned_real_button_release_event;
	((GtkWidgetClass *) klass)->grab_broken_event = (gboolean (*) (GtkWidget *, GdkEventGrabBroken*)) granite_widgets_thin_paned_real_grab_broken_event;
	G_OBJECT_CLASS (klass)->finalize = granite_widgets_thin_paned_finalize;
	_tmp0_ = g_param_spec_int (GRANITE_WIDGETS_THIN_PANED_STYLE_PROP_OVERLAY_HANDLE_SIZE, "Overlay handle's size", "Width of the invisible overlay handle", 1, 50, 10, G_PARAM_READABLE);
	_tmp1_ = _tmp0_;
	gtk_widget_class_install_style_property (GTK_WIDGET_CLASS (klass), (GParamSpec*) _tmp1_);
	_g_param_spec_unref0 (_tmp1_);
}


static void granite_widgets_thin_paned_instance_init (GraniteWidgetsThinPaned * self) {
	self->priv = GRANITE_WIDGETS_THIN_PANED_GET_PRIVATE (self);
	self->priv->in_resize = FALSE;
}


static void granite_widgets_thin_paned_finalize (GObject * obj) {
	GraniteWidgetsThinPaned * self;
	self = G_TYPE_CHECK_INSTANCE_CAST (obj, GRANITE_WIDGETS_TYPE_THIN_PANED, GraniteWidgetsThinPaned);
	_g_object_unref0 (self->priv->overlay_handle);
	G_OBJECT_CLASS (granite_widgets_thin_paned_parent_class)->finalize (obj);
}


/**
 * A widget with two adjustable panes.
 *
 * A ThinPaned widget draws a thin separator between two child widgets, without
 * compromising usability, because it offers a wide-enough invisible handle that the user
 * can drag to adjust the division.
 *
 * The size of the invisible handle can be customized through the //"overlay-handle-size"//
 * style property. For instance:
 *
 * {{{
 * * {
 *     -GraniteWidgetsThinPaned-overlay-handle-size: 8px;
 * }
 * }}}
 *
 * @see Gtk.Paned
 * @since 0.2
 */
GType granite_widgets_thin_paned_get_type (void) {
	static volatile gsize granite_widgets_thin_paned_type_id__volatile = 0;
	if (g_once_init_enter (&granite_widgets_thin_paned_type_id__volatile)) {
		static const GTypeInfo g_define_type_info = { sizeof (GraniteWidgetsThinPanedClass), (GBaseInitFunc) NULL, (GBaseFinalizeFunc) NULL, (GClassInitFunc) granite_widgets_thin_paned_class_init, (GClassFinalizeFunc) NULL, NULL, sizeof (GraniteWidgetsThinPaned), 0, (GInstanceInitFunc) granite_widgets_thin_paned_instance_init, NULL };
		GType granite_widgets_thin_paned_type_id;
		granite_widgets_thin_paned_type_id = g_type_register_static (gtk_paned_get_type (), "GraniteWidgetsThinPaned", &g_define_type_info, 0);
		g_once_init_leave (&granite_widgets_thin_paned_type_id__volatile, granite_widgets_thin_paned_type_id);
	}
	return granite_widgets_thin_paned_type_id__volatile;
}



