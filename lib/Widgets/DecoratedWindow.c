/* DecoratedWindow.c generated by valac 0.36.7, the Vala compiler
 * generated from DecoratedWindow.vala, do not modify */


#include <glib.h>
#include <glib-object.h>
#include <gtk/gtk.h>
#include <gdk-pixbuf/gdk-pixbuf.h>
#include <gdk/gdk.h>
#include <stdlib.h>
#include <string.h>
#include <float.h>
#include <math.h>
#include <pango/pango.h>
#include <cairo.h>


#define GRANITE_WIDGETS_TYPE_COMPOSITED_WINDOW (granite_widgets_composited_window_get_type ())
#define GRANITE_WIDGETS_COMPOSITED_WINDOW(obj) (G_TYPE_CHECK_INSTANCE_CAST ((obj), GRANITE_WIDGETS_TYPE_COMPOSITED_WINDOW, GraniteWidgetsCompositedWindow))
#define GRANITE_WIDGETS_COMPOSITED_WINDOW_CLASS(klass) (G_TYPE_CHECK_CLASS_CAST ((klass), GRANITE_WIDGETS_TYPE_COMPOSITED_WINDOW, GraniteWidgetsCompositedWindowClass))
#define GRANITE_WIDGETS_IS_COMPOSITED_WINDOW(obj) (G_TYPE_CHECK_INSTANCE_TYPE ((obj), GRANITE_WIDGETS_TYPE_COMPOSITED_WINDOW))
#define GRANITE_WIDGETS_IS_COMPOSITED_WINDOW_CLASS(klass) (G_TYPE_CHECK_CLASS_TYPE ((klass), GRANITE_WIDGETS_TYPE_COMPOSITED_WINDOW))
#define GRANITE_WIDGETS_COMPOSITED_WINDOW_GET_CLASS(obj) (G_TYPE_INSTANCE_GET_CLASS ((obj), GRANITE_WIDGETS_TYPE_COMPOSITED_WINDOW, GraniteWidgetsCompositedWindowClass))

typedef struct _GraniteWidgetsCompositedWindow GraniteWidgetsCompositedWindow;
typedef struct _GraniteWidgetsCompositedWindowClass GraniteWidgetsCompositedWindowClass;
typedef struct _GraniteWidgetsCompositedWindowPrivate GraniteWidgetsCompositedWindowPrivate;

#define GRANITE_WIDGETS_TYPE_DECORATED_WINDOW (granite_widgets_decorated_window_get_type ())
#define GRANITE_WIDGETS_DECORATED_WINDOW(obj) (G_TYPE_CHECK_INSTANCE_CAST ((obj), GRANITE_WIDGETS_TYPE_DECORATED_WINDOW, GraniteWidgetsDecoratedWindow))
#define GRANITE_WIDGETS_DECORATED_WINDOW_CLASS(klass) (G_TYPE_CHECK_CLASS_CAST ((klass), GRANITE_WIDGETS_TYPE_DECORATED_WINDOW, GraniteWidgetsDecoratedWindowClass))
#define GRANITE_WIDGETS_IS_DECORATED_WINDOW(obj) (G_TYPE_CHECK_INSTANCE_TYPE ((obj), GRANITE_WIDGETS_TYPE_DECORATED_WINDOW))
#define GRANITE_WIDGETS_IS_DECORATED_WINDOW_CLASS(klass) (G_TYPE_CHECK_CLASS_TYPE ((klass), GRANITE_WIDGETS_TYPE_DECORATED_WINDOW))
#define GRANITE_WIDGETS_DECORATED_WINDOW_GET_CLASS(obj) (G_TYPE_INSTANCE_GET_CLASS ((obj), GRANITE_WIDGETS_TYPE_DECORATED_WINDOW, GraniteWidgetsDecoratedWindowClass))

typedef struct _GraniteWidgetsDecoratedWindow GraniteWidgetsDecoratedWindow;
typedef struct _GraniteWidgetsDecoratedWindowClass GraniteWidgetsDecoratedWindowClass;
typedef struct _GraniteWidgetsDecoratedWindowPrivate GraniteWidgetsDecoratedWindowPrivate;

#define GRANITE_DRAWING_TYPE_BUFFER_SURFACE (granite_drawing_buffer_surface_get_type ())
#define GRANITE_DRAWING_BUFFER_SURFACE(obj) (G_TYPE_CHECK_INSTANCE_CAST ((obj), GRANITE_DRAWING_TYPE_BUFFER_SURFACE, GraniteDrawingBufferSurface))
#define GRANITE_DRAWING_BUFFER_SURFACE_CLASS(klass) (G_TYPE_CHECK_CLASS_CAST ((klass), GRANITE_DRAWING_TYPE_BUFFER_SURFACE, GraniteDrawingBufferSurfaceClass))
#define GRANITE_DRAWING_IS_BUFFER_SURFACE(obj) (G_TYPE_CHECK_INSTANCE_TYPE ((obj), GRANITE_DRAWING_TYPE_BUFFER_SURFACE))
#define GRANITE_DRAWING_IS_BUFFER_SURFACE_CLASS(klass) (G_TYPE_CHECK_CLASS_TYPE ((klass), GRANITE_DRAWING_TYPE_BUFFER_SURFACE))
#define GRANITE_DRAWING_BUFFER_SURFACE_GET_CLASS(obj) (G_TYPE_INSTANCE_GET_CLASS ((obj), GRANITE_DRAWING_TYPE_BUFFER_SURFACE, GraniteDrawingBufferSurfaceClass))

typedef struct _GraniteDrawingBufferSurface GraniteDrawingBufferSurface;
typedef struct _GraniteDrawingBufferSurfaceClass GraniteDrawingBufferSurfaceClass;
#define _g_object_unref0(var) ((var == NULL) ? NULL : (var = (g_object_unref (var), NULL)))
#define __vala_PangoFontDescription_free0(var) ((var == NULL) ? NULL : (var = (_vala_PangoFontDescription_free (var), NULL)))
#define _pango_attr_list_unref0(var) ((var == NULL) ? NULL : (var = (pango_attr_list_unref (var), NULL)))

struct _GraniteWidgetsCompositedWindow {
	GtkWindow parent_instance;
	GraniteWidgetsCompositedWindowPrivate * priv;
};

struct _GraniteWidgetsCompositedWindowClass {
	GtkWindowClass parent_class;
};

struct _GraniteWidgetsDecoratedWindow {
	GraniteWidgetsCompositedWindow parent_instance;
	GraniteWidgetsDecoratedWindowPrivate * priv;
	GdkPixbuf* close_img;
};

struct _GraniteWidgetsDecoratedWindowClass {
	GraniteWidgetsCompositedWindowClass parent_class;
};

struct _GraniteWidgetsDecoratedWindowPrivate {
	gboolean _show_title;
	GtkBox* _box;
	GtkWindow* _draw_ref;
	GraniteDrawingBufferSurface* buffer;
	gint w;
	gint h;
	GtkLabel* _title;
};


static gpointer granite_widgets_decorated_window_parent_class = NULL;

GType granite_widgets_composited_window_get_type (void) G_GNUC_CONST;
GType granite_widgets_decorated_window_get_type (void) G_GNUC_CONST;
GType granite_drawing_buffer_surface_get_type (void) G_GNUC_CONST;
#define GRANITE_WIDGETS_DECORATED_WINDOW_GET_PRIVATE(o) (G_TYPE_INSTANCE_GET_PRIVATE ((o), GRANITE_WIDGETS_TYPE_DECORATED_WINDOW, GraniteWidgetsDecoratedWindowPrivate))
enum  {
	GRANITE_WIDGETS_DECORATED_WINDOW_0_PROPERTY,
	GRANITE_WIDGETS_DECORATED_WINDOW_SHOW_TITLE_PROPERTY,
	GRANITE_WIDGETS_DECORATED_WINDOW_BOX_PROPERTY,
	GRANITE_WIDGETS_DECORATED_WINDOW_DRAW_REF_PROPERTY
};
#define GRANITE_WIDGETS_DECORATED_WINDOW_DECORATED_WINDOW_FALLBACK_STYLESHEET "\n" \
"            .decorated-window {\n" \
"                border-style:solid;\n" \
"                border-color:alpha (#000, 0.35);\n" \
"                background-image:none;\n" \
"                background-color:@bg_color;\n" \
"                border-radius:6px;\n" \
"            }\n" \
"        "
#define GRANITE_WIDGETS_DECORATED_WINDOW_DECORATED_WINDOW_STYLESHEET "\n            .decorated-window { border-width:1px; }\n        "
#define GRANITE_WIDGETS_DECORATED_WINDOW_SHADOW_BLUR 15
#define GRANITE_WIDGETS_DECORATED_WINDOW_SHADOW_X 0
#define GRANITE_WIDGETS_DECORATED_WINDOW_SHADOW_Y 0
#define GRANITE_WIDGETS_DECORATED_WINDOW_CLOSE_BUTTON_X -3
#define GRANITE_WIDGETS_DECORATED_WINDOW_CLOSE_BUTTON_Y -3
#define GRANITE_WIDGETS_DECORATED_WINDOW_SHADOW_ALPHA 0.3
void granite_widgets_decorated_window_set_default_theming (GtkWindow* ref_window);
GtkCssProvider* granite_widgets_utils_set_theming (GtkWidget* widget, const gchar* stylesheet, const gchar* class_name, gint priority);
#define GRANITE_STYLE_CLASS_DECORATED_WINDOW "decorated-window"
GraniteWidgetsDecoratedWindow* granite_widgets_decorated_window_new (const gchar* title, const gchar* window_style, const gchar* content_style);
GraniteWidgetsDecoratedWindow* granite_widgets_decorated_window_construct (GType object_type, const gchar* title, const gchar* window_style, const gchar* content_style);
GraniteWidgetsCompositedWindow* granite_widgets_composited_window_new (void);
GraniteWidgetsCompositedWindow* granite_widgets_composited_window_construct (GType object_type);
GdkPixbuf* get_close_pixbuf (void);
static void _vala_PangoFontDescription_free (PangoFontDescription* self);
static void granite_widgets_decorated_window_update_titlebar_label (GraniteWidgetsDecoratedWindow* self);
static void _granite_widgets_decorated_window_update_titlebar_label_g_object_notify (GObject* _sender, GParamSpec* pspec, gpointer self);
static void __lambda9_ (GraniteWidgetsDecoratedWindow* self);
static void ___lambda9__g_object_notify (GObject* _sender, GParamSpec* pspec, gpointer self);
static void granite_widgets_decorated_window_set_box (GraniteWidgetsDecoratedWindow* self, GtkBox* value);
GtkBox* granite_widgets_decorated_window_get_box (GraniteWidgetsDecoratedWindow* self);
static void granite_widgets_decorated_window_set_draw_ref (GraniteWidgetsDecoratedWindow* self, GtkWindow* value);
GtkWindow* granite_widgets_decorated_window_get_draw_ref (GraniteWidgetsDecoratedWindow* self);
static gboolean granite_widgets_decorated_window_on_motion_notify (GraniteWidgetsDecoratedWindow* self, GdkEventMotion* e);
static gboolean _granite_widgets_decorated_window_on_motion_notify_gtk_widget_motion_notify_event (GtkWidget* _sender, GdkEventMotion* event, gpointer self);
static gboolean granite_widgets_decorated_window_on_delete_event (GraniteWidgetsDecoratedWindow* self, GdkEventAny* event);
static gboolean _granite_widgets_decorated_window_on_delete_event_gtk_widget_delete_event (GtkWidget* _sender, GdkEventAny* event, gpointer self);
static void granite_widgets_decorated_window_on_size_allocate (GraniteWidgetsDecoratedWindow* self, GtkAllocation* alloc);
static void _granite_widgets_decorated_window_on_size_allocate_gtk_widget_size_allocate (GtkWidget* _sender, GtkAllocation* allocation, gpointer self);
static gboolean granite_widgets_decorated_window_draw_widget (GraniteWidgetsDecoratedWindow* self, cairo_t* ctx);
static gboolean _granite_widgets_decorated_window_draw_widget_gtk_widget_draw (GtkWidget* _sender, cairo_t* cr, gpointer self);
void granite_widgets_decorated_window_add (GraniteWidgetsDecoratedWindow* self, GtkWidget* w);
void granite_widgets_decorated_window_remove (GraniteWidgetsDecoratedWindow* self, GtkWidget* w);
gboolean granite_widgets_decorated_window_get_show_title (GraniteWidgetsDecoratedWindow* self);
cairo_surface_t* granite_drawing_buffer_surface_get_surface (GraniteDrawingBufferSurface* self);
GraniteDrawingBufferSurface* granite_drawing_buffer_surface_new (gint width, gint height);
GraniteDrawingBufferSurface* granite_drawing_buffer_surface_construct (GType object_type, gint width, gint height);
cairo_t* granite_drawing_buffer_surface_get_context (GraniteDrawingBufferSurface* self);
void granite_drawing_buffer_surface_exponential_blur (GraniteDrawingBufferSurface* self, gint radius);
static gboolean granite_widgets_decorated_window_coords_over_close_button (GraniteWidgetsDecoratedWindow* self, gdouble x_root, gdouble y_root);
static gboolean granite_widgets_decorated_window_real_button_press_event (GtkWidget* base, GdkEventButton* e);
static gboolean granite_widgets_decorated_window_real_button_release_event (GtkWidget* base, GdkEventButton* e);
static gboolean granite_widgets_decorated_window_real_key_press_event (GtkWidget* base, GdkEventKey* event);
void granite_widgets_decorated_window_set_show_title (GraniteWidgetsDecoratedWindow* self, gboolean value);
static void granite_widgets_decorated_window_finalize (GObject * obj);
static void _vala_granite_widgets_decorated_window_get_property (GObject * object, guint property_id, GValue * value, GParamSpec * pspec);
static void _vala_granite_widgets_decorated_window_set_property (GObject * object, guint property_id, const GValue * value, GParamSpec * pspec);


/**
         * This method sets the given window to the decorated window style
         *
         * @param ref_window window to set style to
         */
void granite_widgets_decorated_window_set_default_theming (GtkWindow* ref_window) {
	GtkWindow* _tmp0_;
	GtkCssProvider* _tmp1_;
	GtkCssProvider* _tmp2_;
	GtkWindow* _tmp3_;
	GtkCssProvider* _tmp4_;
	GtkCssProvider* _tmp5_;
	g_return_if_fail (ref_window != NULL);
	_tmp0_ = ref_window;
	_tmp1_ = granite_widgets_utils_set_theming ((GtkWidget*) _tmp0_, GRANITE_WIDGETS_DECORATED_WINDOW_DECORATED_WINDOW_STYLESHEET, GRANITE_STYLE_CLASS_DECORATED_WINDOW, GTK_STYLE_PROVIDER_PRIORITY_APPLICATION);
	_tmp2_ = _tmp1_;
	_g_object_unref0 (_tmp2_);
	_tmp3_ = ref_window;
	_tmp4_ = granite_widgets_utils_set_theming ((GtkWidget*) _tmp3_, GRANITE_WIDGETS_DECORATED_WINDOW_DECORATED_WINDOW_FALLBACK_STYLESHEET, GRANITE_STYLE_CLASS_DECORATED_WINDOW, GTK_STYLE_PROVIDER_PRIORITY_FALLBACK);
	_tmp5_ = _tmp4_;
	_g_object_unref0 (_tmp5_);
}


/**
         * This creates a new DecoratedWindow
         *
         * @param title title to set window's title to
         * @param window_style style to set window to
         * @param content_style style to set content to
         */
static void _vala_PangoFontDescription_free (PangoFontDescription* self) {
	g_boxed_free (pango_font_description_get_type (), self);
}


static void _granite_widgets_decorated_window_update_titlebar_label_g_object_notify (GObject* _sender, GParamSpec* pspec, gpointer self) {
	granite_widgets_decorated_window_update_titlebar_label ((GraniteWidgetsDecoratedWindow*) self);
}


static void __lambda9_ (GraniteWidgetsDecoratedWindow* self) {
	self->priv->w = -1;
	self->priv->h = -1;
	gtk_widget_queue_resize ((GtkWidget*) self);
	gtk_widget_queue_draw ((GtkWidget*) self);
}


static void ___lambda9__g_object_notify (GObject* _sender, GParamSpec* pspec, gpointer self) {
	__lambda9_ ((GraniteWidgetsDecoratedWindow*) self);
}


static gboolean _granite_widgets_decorated_window_on_motion_notify_gtk_widget_motion_notify_event (GtkWidget* _sender, GdkEventMotion* event, gpointer self) {
	gboolean result;
	result = granite_widgets_decorated_window_on_motion_notify ((GraniteWidgetsDecoratedWindow*) self, event);
	return result;
}


static gboolean _granite_widgets_decorated_window_on_delete_event_gtk_widget_delete_event (GtkWidget* _sender, GdkEventAny* event, gpointer self) {
	gboolean result;
	result = granite_widgets_decorated_window_on_delete_event ((GraniteWidgetsDecoratedWindow*) self, event);
	return result;
}


static void _granite_widgets_decorated_window_on_size_allocate_gtk_widget_size_allocate (GtkWidget* _sender, GtkAllocation* allocation, gpointer self) {
	granite_widgets_decorated_window_on_size_allocate ((GraniteWidgetsDecoratedWindow*) self, allocation);
}


static gboolean _granite_widgets_decorated_window_draw_widget_gtk_widget_draw (GtkWidget* _sender, cairo_t* cr, gpointer self) {
	gboolean result;
	result = granite_widgets_decorated_window_draw_widget ((GraniteWidgetsDecoratedWindow*) self, cr);
	return result;
}


GraniteWidgetsDecoratedWindow* granite_widgets_decorated_window_construct (GType object_type, const gchar* title, const gchar* window_style, const gchar* content_style) {
	GraniteWidgetsDecoratedWindow * self = NULL;
	GdkPixbuf* _tmp0_;
	GtkLabel* _tmp1_;
	GtkLabel* _tmp2_;
	GtkLabel* _tmp3_;
	GtkLabel* _tmp4_;
	GtkLabel* _tmp5_;
	GtkLabel* _tmp6_;
	GtkLabel* _tmp7_;
	GtkLabel* _tmp8_;
	GdkPixbuf* _tmp9_;
	gint _tmp10_;
	PangoAttrList* attr = NULL;
	PangoAttrList* _tmp11_;
	PangoAttrList* _tmp12_;
	PangoFontDescription* _tmp13_;
	PangoFontDescription* _tmp14_;
	PangoAttrFontDesc* _tmp15_;
	GtkLabel* _tmp16_;
	PangoAttrList* _tmp17_;
	const gchar* _tmp18_;
	GtkBox* _tmp19_;
	GtkBox* _tmp20_;
	GtkBox* _tmp21_;
	GtkWindow* _tmp22_;
	GtkWindow* _tmp23_;
	GtkWindow* _tmp24_;
	gboolean _tmp25_ = FALSE;
	const gchar* _tmp26_;
	gboolean _tmp31_ = FALSE;
	const gchar* _tmp32_;
	GtkBox* _tmp37_;
	GtkLabel* _tmp38_;
	GtkBox* _tmp39_;
	g_return_val_if_fail (title != NULL, NULL);
	self = (GraniteWidgetsDecoratedWindow*) granite_widgets_composited_window_construct (object_type);
	gtk_window_set_resizable ((GtkWindow*) self, FALSE);
	gtk_window_set_has_resize_grip ((GtkWindow*) self, FALSE);
	g_object_set ((GtkWindow*) self, "window-position", GTK_WIN_POS_CENTER_ON_PARENT, NULL);
	_tmp0_ = get_close_pixbuf ();
	_g_object_unref0 (self->close_img);
	self->close_img = _tmp0_;
	_tmp1_ = (GtkLabel*) gtk_label_new (NULL);
	g_object_ref_sink (_tmp1_);
	_g_object_unref0 (self->priv->_title);
	self->priv->_title = _tmp1_;
	_tmp2_ = self->priv->_title;
	gtk_widget_set_halign ((GtkWidget*) _tmp2_, GTK_ALIGN_CENTER);
	_tmp3_ = self->priv->_title;
	gtk_widget_set_hexpand ((GtkWidget*) _tmp3_, FALSE);
	_tmp4_ = self->priv->_title;
	gtk_label_set_ellipsize (_tmp4_, PANGO_ELLIPSIZE_MIDDLE);
	_tmp5_ = self->priv->_title;
	gtk_label_set_single_line_mode (_tmp5_, TRUE);
	_tmp6_ = self->priv->_title;
	g_object_set ((GtkWidget*) _tmp6_, "margin", 6, NULL);
	_tmp7_ = self->priv->_title;
	_tmp8_ = self->priv->_title;
	_tmp9_ = self->close_img;
	_tmp10_ = gdk_pixbuf_get_width (_tmp9_);
	gtk_widget_set_margin_right ((GtkWidget*) _tmp8_, 6 + (_tmp10_ / 3));
	gtk_widget_set_margin_left ((GtkWidget*) _tmp7_, 6 + (_tmp10_ / 3));
	_tmp11_ = pango_attr_list_new ();
	attr = _tmp11_;
	_tmp12_ = attr;
	_tmp13_ = pango_font_description_from_string ("bold");
	_tmp14_ = _tmp13_;
	_tmp15_ = (PangoAttrFontDesc*) pango_attr_font_desc_new (_tmp14_);
	pango_attr_list_insert (_tmp12_, (PangoAttribute*) _tmp15_);
	__vala_PangoFontDescription_free0 (_tmp14_);
	_tmp16_ = self->priv->_title;
	_tmp17_ = attr;
	gtk_label_set_attributes (_tmp16_, _tmp17_);
	g_signal_connect_object ((GObject*) self, "notify::title", (GCallback) _granite_widgets_decorated_window_update_titlebar_label_g_object_notify, self, 0);
	g_signal_connect_object ((GObject*) self, "notify::show-title", (GCallback) _granite_widgets_decorated_window_update_titlebar_label_g_object_notify, self, 0);
	g_signal_connect_object ((GObject*) self, "notify::deletable", (GCallback) ___lambda9__g_object_notify, self, 0);
	_tmp18_ = title;
	gtk_window_set_title ((GtkWindow*) self, _tmp18_);
	gtk_window_set_deletable ((GtkWindow*) self, TRUE);
	_tmp19_ = (GtkBox*) gtk_box_new (GTK_ORIENTATION_VERTICAL, 0);
	g_object_ref_sink (_tmp19_);
	_tmp20_ = _tmp19_;
	granite_widgets_decorated_window_set_box (self, _tmp20_);
	_g_object_unref0 (_tmp20_);
	_tmp21_ = self->priv->_box;
	g_object_set ((GtkWidget*) _tmp21_, "margin", GRANITE_WIDGETS_DECORATED_WINDOW_SHADOW_BLUR + 1, NULL);
	_tmp22_ = (GtkWindow*) gtk_window_new (GTK_WINDOW_TOPLEVEL);
	g_object_ref_sink (_tmp22_);
	_tmp23_ = _tmp22_;
	granite_widgets_decorated_window_set_draw_ref (self, _tmp23_);
	_g_object_unref0 (_tmp23_);
	_tmp24_ = self->priv->_draw_ref;
	granite_widgets_decorated_window_set_default_theming (_tmp24_);
	_tmp26_ = window_style;
	if (_tmp26_ != NULL) {
		const gchar* _tmp27_;
		_tmp27_ = window_style;
		_tmp25_ = g_strcmp0 (_tmp27_, "") != 0;
	} else {
		_tmp25_ = FALSE;
	}
	if (_tmp25_) {
		GtkWindow* _tmp28_;
		GtkStyleContext* _tmp29_;
		const gchar* _tmp30_;
		_tmp28_ = self->priv->_draw_ref;
		_tmp29_ = gtk_widget_get_style_context ((GtkWidget*) _tmp28_);
		_tmp30_ = window_style;
		gtk_style_context_add_class (_tmp29_, _tmp30_);
	}
	_tmp32_ = content_style;
	if (_tmp32_ != NULL) {
		const gchar* _tmp33_;
		_tmp33_ = content_style;
		_tmp31_ = g_strcmp0 (_tmp33_, "") != 0;
	} else {
		_tmp31_ = FALSE;
	}
	if (_tmp31_) {
		GtkBox* _tmp34_;
		GtkStyleContext* _tmp35_;
		const gchar* _tmp36_;
		_tmp34_ = self->priv->_box;
		_tmp35_ = gtk_widget_get_style_context ((GtkWidget*) _tmp34_);
		_tmp36_ = content_style;
		gtk_style_context_add_class (_tmp35_, _tmp36_);
	}
	_tmp37_ = self->priv->_box;
	_tmp38_ = self->priv->_title;
	gtk_box_pack_start (_tmp37_, (GtkWidget*) _tmp38_, FALSE, TRUE, (guint) 0);
	_tmp39_ = self->priv->_box;
	GTK_CONTAINER_CLASS (granite_widgets_decorated_window_parent_class)->add ((GtkContainer*) G_TYPE_CHECK_INSTANCE_CAST (self, GRANITE_WIDGETS_TYPE_COMPOSITED_WINDOW, GraniteWidgetsCompositedWindow), (GtkWidget*) _tmp39_);
	gtk_widget_add_events ((GtkWidget*) self, (gint) ((GDK_BUTTON_PRESS_MASK | GDK_BUTTON_RELEASE_MASK) | GDK_POINTER_MOTION_MASK));
	g_signal_connect_object ((GtkWidget*) self, "motion-notify-event", (GCallback) _granite_widgets_decorated_window_on_motion_notify_gtk_widget_motion_notify_event, self, 0);
	g_signal_connect_object ((GtkWidget*) self, "delete-event", (GCallback) _granite_widgets_decorated_window_on_delete_event_gtk_widget_delete_event, self, G_CONNECT_AFTER);
	g_signal_connect_object ((GtkWidget*) self, "size-allocate", (GCallback) _granite_widgets_decorated_window_on_size_allocate_gtk_widget_size_allocate, self, 0);
	g_signal_connect_object ((GtkWidget*) self, "draw", (GCallback) _granite_widgets_decorated_window_draw_widget_gtk_widget_draw, self, 0);
	_pango_attr_list_unref0 (attr);
	return self;
}


GraniteWidgetsDecoratedWindow* granite_widgets_decorated_window_new (const gchar* title, const gchar* window_style, const gchar* content_style) {
	return granite_widgets_decorated_window_construct (GRANITE_WIDGETS_TYPE_DECORATED_WINDOW, title, window_style, content_style);
}


/**
         * This method adds new item to window
         *
         * @param w widget to add to window
         */
void granite_widgets_decorated_window_add (GraniteWidgetsDecoratedWindow* self, GtkWidget* w) {
	GtkBox* _tmp0_;
	GtkWidget* _tmp1_;
	g_return_if_fail (self != NULL);
	g_return_if_fail (w != NULL);
	_tmp0_ = self->priv->_box;
	_tmp1_ = w;
	gtk_box_pack_start (_tmp0_, _tmp1_, TRUE, TRUE, (guint) 0);
}


/**
         * This method removes item to window
         *
         * @param w widget to remove from window
         */
void granite_widgets_decorated_window_remove (GraniteWidgetsDecoratedWindow* self, GtkWidget* w) {
	GtkBox* _tmp0_;
	GtkWidget* _tmp1_;
	g_return_if_fail (self != NULL);
	g_return_if_fail (w != NULL);
	_tmp0_ = self->priv->_box;
	_tmp1_ = w;
	gtk_container_remove ((GtkContainer*) _tmp0_, _tmp1_);
}


static void granite_widgets_decorated_window_update_titlebar_label (GraniteWidgetsDecoratedWindow* self) {
	const gchar* _tmp0_ = NULL;
	gboolean _tmp1_;
	GtkLabel* _tmp4_;
	g_return_if_fail (self != NULL);
	_tmp1_ = self->priv->_show_title;
	if (_tmp1_) {
		const gchar* _tmp2_;
		const gchar* _tmp3_;
		_tmp2_ = gtk_window_get_title ((GtkWindow*) self);
		_tmp3_ = _tmp2_;
		_tmp0_ = _tmp3_;
	} else {
		_tmp0_ = "";
	}
	_tmp4_ = self->priv->_title;
	gtk_label_set_label (_tmp4_, _tmp0_);
}


static gboolean granite_widgets_decorated_window_draw_widget (GraniteWidgetsDecoratedWindow* self, cairo_t* ctx) {
	gboolean result = FALSE;
	cairo_t* _tmp0_;
	GraniteDrawingBufferSurface* _tmp1_;
	cairo_surface_t* _tmp2_;
	cairo_surface_t* _tmp3_;
	cairo_t* _tmp4_;
	g_return_val_if_fail (self != NULL, FALSE);
	g_return_val_if_fail (ctx != NULL, FALSE);
	_tmp0_ = ctx;
	_tmp1_ = self->priv->buffer;
	_tmp2_ = granite_drawing_buffer_surface_get_surface (_tmp1_);
	_tmp3_ = _tmp2_;
	cairo_set_source_surface (_tmp0_, _tmp3_, (gdouble) 0, (gdouble) 0);
	_tmp4_ = ctx;
	cairo_paint (_tmp4_);
	result = FALSE;
	return result;
}


static void granite_widgets_decorated_window_on_size_allocate (GraniteWidgetsDecoratedWindow* self, GtkAllocation* alloc) {
	gboolean _tmp0_ = FALSE;
	GtkAllocation _tmp1_;
	gint _tmp2_;
	gint _tmp3_;
	GtkAllocation _tmp7_;
	gint _tmp8_;
	GtkAllocation _tmp9_;
	gint _tmp10_;
	gint _tmp11_;
	gint _tmp12_;
	GraniteDrawingBufferSurface* _tmp13_;
	gint x = 0;
	gint y = 0;
	gint width = 0;
	gint _tmp14_;
	gint height = 0;
	gint _tmp15_;
	GraniteDrawingBufferSurface* _tmp16_;
	cairo_t* _tmp17_;
	cairo_t* _tmp18_;
	gint _tmp19_;
	gint _tmp20_;
	gint _tmp21_;
	gint _tmp22_;
	GraniteDrawingBufferSurface* _tmp23_;
	cairo_t* _tmp24_;
	cairo_t* _tmp25_;
	GraniteDrawingBufferSurface* _tmp26_;
	cairo_t* _tmp27_;
	cairo_t* _tmp28_;
	GraniteDrawingBufferSurface* _tmp29_;
	GtkWindow* _tmp30_;
	GtkStyleContext* _tmp31_;
	GraniteDrawingBufferSurface* _tmp32_;
	cairo_t* _tmp33_;
	cairo_t* _tmp34_;
	gint _tmp35_;
	gint _tmp36_;
	gint _tmp37_;
	gint _tmp38_;
	gboolean _tmp39_;
	gboolean _tmp40_;
	g_return_if_fail (self != NULL);
	g_return_if_fail (alloc != NULL);
	_tmp1_ = *alloc;
	_tmp2_ = _tmp1_.width;
	_tmp3_ = self->priv->w;
	if (_tmp2_ == _tmp3_) {
		gint _tmp4_;
		GtkAllocation _tmp5_;
		gint _tmp6_;
		_tmp4_ = self->priv->h;
		_tmp5_ = *alloc;
		_tmp6_ = _tmp5_.height;
		_tmp0_ = _tmp4_ == _tmp6_;
	} else {
		_tmp0_ = FALSE;
	}
	if (_tmp0_) {
		return;
	}
	_tmp7_ = *alloc;
	_tmp8_ = _tmp7_.width;
	self->priv->w = _tmp8_;
	_tmp9_ = *alloc;
	_tmp10_ = _tmp9_.height;
	self->priv->h = _tmp10_;
	_tmp11_ = self->priv->w;
	_tmp12_ = self->priv->h;
	_tmp13_ = granite_drawing_buffer_surface_new (_tmp11_, _tmp12_);
	_g_object_unref0 (self->priv->buffer);
	self->priv->buffer = _tmp13_;
	x = GRANITE_WIDGETS_DECORATED_WINDOW_SHADOW_BLUR + GRANITE_WIDGETS_DECORATED_WINDOW_SHADOW_X;
	y = GRANITE_WIDGETS_DECORATED_WINDOW_SHADOW_BLUR + GRANITE_WIDGETS_DECORATED_WINDOW_SHADOW_Y;
	_tmp14_ = self->priv->w;
	width = (_tmp14_ - (2 * GRANITE_WIDGETS_DECORATED_WINDOW_SHADOW_BLUR)) + GRANITE_WIDGETS_DECORATED_WINDOW_SHADOW_X;
	_tmp15_ = self->priv->h;
	height = (_tmp15_ - (2 * GRANITE_WIDGETS_DECORATED_WINDOW_SHADOW_BLUR)) + GRANITE_WIDGETS_DECORATED_WINDOW_SHADOW_Y;
	_tmp16_ = self->priv->buffer;
	_tmp17_ = granite_drawing_buffer_surface_get_context (_tmp16_);
	_tmp18_ = _tmp17_;
	_tmp19_ = x;
	_tmp20_ = y;
	_tmp21_ = width;
	_tmp22_ = height;
	cairo_rectangle (_tmp18_, (gdouble) _tmp19_, (gdouble) _tmp20_, (gdouble) _tmp21_, (gdouble) _tmp22_);
	_tmp23_ = self->priv->buffer;
	_tmp24_ = granite_drawing_buffer_surface_get_context (_tmp23_);
	_tmp25_ = _tmp24_;
	cairo_set_source_rgba (_tmp25_, (gdouble) 0, (gdouble) 0, (gdouble) 0, GRANITE_WIDGETS_DECORATED_WINDOW_SHADOW_ALPHA);
	_tmp26_ = self->priv->buffer;
	_tmp27_ = granite_drawing_buffer_surface_get_context (_tmp26_);
	_tmp28_ = _tmp27_;
	cairo_fill (_tmp28_);
	_tmp29_ = self->priv->buffer;
	granite_drawing_buffer_surface_exponential_blur (_tmp29_, GRANITE_WIDGETS_DECORATED_WINDOW_SHADOW_BLUR / 2);
	_tmp30_ = self->priv->_draw_ref;
	_tmp31_ = gtk_widget_get_style_context ((GtkWidget*) _tmp30_);
	_tmp32_ = self->priv->buffer;
	_tmp33_ = granite_drawing_buffer_surface_get_context (_tmp32_);
	_tmp34_ = _tmp33_;
	_tmp35_ = x;
	_tmp36_ = y;
	_tmp37_ = width;
	_tmp38_ = height;
	gtk_render_activity (_tmp31_, _tmp34_, (gdouble) _tmp35_, (gdouble) _tmp36_, (gdouble) _tmp37_, (gdouble) _tmp38_);
	_tmp39_ = gtk_window_get_deletable ((GtkWindow*) self);
	_tmp40_ = _tmp39_;
	if (_tmp40_) {
		GraniteDrawingBufferSurface* _tmp41_;
		cairo_t* _tmp42_;
		cairo_t* _tmp43_;
		GdkPixbuf* _tmp44_;
		GraniteDrawingBufferSurface* _tmp45_;
		cairo_t* _tmp46_;
		cairo_t* _tmp47_;
		_tmp41_ = self->priv->buffer;
		_tmp42_ = granite_drawing_buffer_surface_get_context (_tmp41_);
		_tmp43_ = _tmp42_;
		_tmp44_ = self->close_img;
		gdk_cairo_set_source_pixbuf (_tmp43_, _tmp44_, (gdouble) ((GRANITE_WIDGETS_DECORATED_WINDOW_SHADOW_BLUR / 2) + GRANITE_WIDGETS_DECORATED_WINDOW_CLOSE_BUTTON_X), (gdouble) ((GRANITE_WIDGETS_DECORATED_WINDOW_SHADOW_BLUR / 2) + GRANITE_WIDGETS_DECORATED_WINDOW_CLOSE_BUTTON_Y));
		_tmp45_ = self->priv->buffer;
		_tmp46_ = granite_drawing_buffer_surface_get_context (_tmp45_);
		_tmp47_ = _tmp46_;
		cairo_paint (_tmp47_);
	}
}


static gboolean granite_widgets_decorated_window_on_motion_notify (GraniteWidgetsDecoratedWindow* self, GdkEventMotion* e) {
	gboolean result = FALSE;
	GdkEventMotion* _tmp0_;
	gdouble _tmp1_;
	GdkEventMotion* _tmp2_;
	gdouble _tmp3_;
	gboolean _tmp4_;
	g_return_val_if_fail (self != NULL, FALSE);
	g_return_val_if_fail (e != NULL, FALSE);
	_tmp0_ = e;
	_tmp1_ = _tmp0_->x_root;
	_tmp2_ = e;
	_tmp3_ = _tmp2_->y_root;
	_tmp4_ = granite_widgets_decorated_window_coords_over_close_button (self, _tmp1_, _tmp3_);
	if (_tmp4_) {
		GdkWindow* _tmp5_;
		GdkCursor* _tmp6_;
		GdkCursor* _tmp7_;
		_tmp5_ = gtk_widget_get_window ((GtkWidget*) self);
		_tmp6_ = gdk_cursor_new (GDK_HAND1);
		_tmp7_ = _tmp6_;
		gdk_window_set_cursor (_tmp5_, _tmp7_);
		_g_object_unref0 (_tmp7_);
	} else {
		GdkWindow* _tmp8_;
		_tmp8_ = gtk_widget_get_window ((GtkWidget*) self);
		gdk_window_set_cursor (_tmp8_, NULL);
	}
	result = TRUE;
	return result;
}


static gboolean granite_widgets_decorated_window_real_button_press_event (GtkWidget* base, GdkEventButton* e) {
	GraniteWidgetsDecoratedWindow * self;
	gboolean result = FALSE;
	GdkEventButton* _tmp0_;
	gdouble _tmp1_;
	GdkEventButton* _tmp2_;
	gdouble _tmp3_;
	gboolean _tmp4_;
	gboolean _tmp5_ = FALSE;
	GdkEventButton* _tmp6_;
	GdkEventType _tmp7_;
	GdkEventButton* _tmp18_;
	gboolean _tmp19_;
	self = (GraniteWidgetsDecoratedWindow*) base;
	g_return_val_if_fail (e != NULL, FALSE);
	_tmp0_ = e;
	_tmp1_ = _tmp0_->x_root;
	_tmp2_ = e;
	_tmp3_ = _tmp2_->y_root;
	_tmp4_ = granite_widgets_decorated_window_coords_over_close_button (self, _tmp1_, _tmp3_);
	if (_tmp4_) {
		result = TRUE;
		return result;
	}
	_tmp6_ = e;
	_tmp7_ = _tmp6_->type;
	if (_tmp7_ == GDK_BUTTON_PRESS) {
		GdkEventButton* _tmp8_;
		guint _tmp9_;
		_tmp8_ = e;
		_tmp9_ = _tmp8_->button;
		_tmp5_ = _tmp9_ == ((guint) 1);
	} else {
		_tmp5_ = FALSE;
	}
	if (_tmp5_) {
		GdkEventButton* _tmp10_;
		guint _tmp11_;
		GdkEventButton* _tmp12_;
		gdouble _tmp13_;
		GdkEventButton* _tmp14_;
		gdouble _tmp15_;
		GdkEventButton* _tmp16_;
		guint32 _tmp17_;
		_tmp10_ = e;
		_tmp11_ = _tmp10_->button;
		_tmp12_ = e;
		_tmp13_ = _tmp12_->x_root;
		_tmp14_ = e;
		_tmp15_ = _tmp14_->y_root;
		_tmp16_ = e;
		_tmp17_ = _tmp16_->time;
		gtk_window_begin_move_drag ((GtkWindow*) self, (gint) _tmp11_, (gint) _tmp13_, (gint) _tmp15_, _tmp17_);
	}
	_tmp18_ = e;
	_tmp19_ = GTK_WIDGET_CLASS (granite_widgets_decorated_window_parent_class)->button_press_event ((GtkWidget*) G_TYPE_CHECK_INSTANCE_CAST (self, GRANITE_WIDGETS_TYPE_COMPOSITED_WINDOW, GraniteWidgetsCompositedWindow), _tmp18_);
	result = _tmp19_;
	return result;
}


static gboolean granite_widgets_decorated_window_real_button_release_event (GtkWidget* base, GdkEventButton* e) {
	GraniteWidgetsDecoratedWindow * self;
	gboolean result = FALSE;
	gboolean on_close_button = FALSE;
	GdkEventButton* _tmp0_;
	gdouble _tmp1_;
	GdkEventButton* _tmp2_;
	gdouble _tmp3_;
	gboolean _tmp4_;
	gboolean _tmp5_;
	self = (GraniteWidgetsDecoratedWindow*) base;
	g_return_val_if_fail (e != NULL, FALSE);
	_tmp0_ = e;
	_tmp1_ = _tmp0_->x_root;
	_tmp2_ = e;
	_tmp3_ = _tmp2_->y_root;
	_tmp4_ = granite_widgets_decorated_window_coords_over_close_button (self, _tmp1_, _tmp3_);
	on_close_button = _tmp4_;
	_tmp5_ = on_close_button;
	if (_tmp5_) {
		GdkEvent* event = NULL;
		GdkEvent* _tmp6_;
		GdkEventAny* _tmp7_;
		GdkEventAny* _tmp8_;
		gboolean _tmp9_ = FALSE;
		event = (GdkEvent*) (&e);
		_tmp6_ = event;
		_tmp7_ = (GdkEventAny *) (_tmp6_);
		_tmp8_ = _tmp7_;
		g_signal_emit_by_name ((GtkWidget*) self, "delete-event", _tmp8_, &_tmp9_);
	}
	result = on_close_button;
	return result;
}


static gboolean granite_widgets_decorated_window_real_key_press_event (GtkWidget* base, GdkEventKey* event) {
	GraniteWidgetsDecoratedWindow * self;
	gboolean result = FALSE;
	GdkEventKey* _tmp0_;
	guint _tmp1_;
	GdkEventKey* _tmp5_;
	gboolean _tmp6_;
	self = (GraniteWidgetsDecoratedWindow*) base;
	g_return_val_if_fail (event != NULL, FALSE);
	_tmp0_ = event;
	_tmp1_ = _tmp0_->keyval;
	if (_tmp1_ == ((guint) GDK_KEY_Escape)) {
		GdkEventAny* _tmp2_;
		GdkEventAny* _tmp3_;
		gboolean _tmp4_ = FALSE;
		_tmp2_ = (GdkEventAny *) ((GdkEvent*) (&event));
		_tmp3_ = _tmp2_;
		g_signal_emit_by_name ((GtkWidget*) self, "delete-event", _tmp3_, &_tmp4_);
		result = TRUE;
		return result;
	}
	_tmp5_ = event;
	_tmp6_ = GTK_WIDGET_CLASS (granite_widgets_decorated_window_parent_class)->key_press_event ((GtkWidget*) G_TYPE_CHECK_INSTANCE_CAST (self, GRANITE_WIDGETS_TYPE_COMPOSITED_WINDOW, GraniteWidgetsCompositedWindow), _tmp5_);
	result = _tmp6_;
	return result;
}


static gboolean granite_widgets_decorated_window_coords_over_close_button (GraniteWidgetsDecoratedWindow* self, gdouble x_root, gdouble y_root) {
	gboolean result = FALSE;
	gint w_x = 0;
	gint w_y = 0;
	gint _tmp0_ = 0;
	gint _tmp1_ = 0;
	gint x = 0;
	gdouble _tmp2_;
	gint _tmp3_;
	gint y = 0;
	gdouble _tmp4_;
	gint _tmp5_;
	gboolean _tmp6_ = FALSE;
	gboolean _tmp7_ = FALSE;
	gboolean _tmp8_ = FALSE;
	gboolean _tmp9_ = FALSE;
	gboolean _tmp10_;
	gboolean _tmp11_;
	g_return_val_if_fail (self != NULL, FALSE);
	gtk_window_get_position ((GtkWindow*) self, &_tmp0_, &_tmp1_);
	w_x = _tmp0_;
	w_y = _tmp1_;
	_tmp2_ = x_root;
	_tmp3_ = w_x;
	x = ((gint) _tmp2_) - _tmp3_;
	_tmp4_ = y_root;
	_tmp5_ = w_y;
	y = ((gint) _tmp4_) - _tmp5_;
	_tmp10_ = gtk_window_get_deletable ((GtkWindow*) self);
	_tmp11_ = _tmp10_;
	if (_tmp11_) {
		gint _tmp12_;
		_tmp12_ = x;
		_tmp9_ = _tmp12_ > ((GRANITE_WIDGETS_DECORATED_WINDOW_SHADOW_BLUR / 2) + GRANITE_WIDGETS_DECORATED_WINDOW_CLOSE_BUTTON_X);
	} else {
		_tmp9_ = FALSE;
	}
	if (_tmp9_) {
		gint _tmp13_;
		GdkPixbuf* _tmp14_;
		gint _tmp15_;
		_tmp13_ = x;
		_tmp14_ = self->close_img;
		_tmp15_ = gdk_pixbuf_get_width (_tmp14_);
		_tmp8_ = _tmp13_ < ((_tmp15_ + (GRANITE_WIDGETS_DECORATED_WINDOW_SHADOW_BLUR / 2)) + GRANITE_WIDGETS_DECORATED_WINDOW_CLOSE_BUTTON_X);
	} else {
		_tmp8_ = FALSE;
	}
	if (_tmp8_) {
		gint _tmp16_;
		_tmp16_ = y;
		_tmp7_ = _tmp16_ > ((GRANITE_WIDGETS_DECORATED_WINDOW_SHADOW_BLUR / 2) + GRANITE_WIDGETS_DECORATED_WINDOW_CLOSE_BUTTON_Y);
	} else {
		_tmp7_ = FALSE;
	}
	if (_tmp7_) {
		gint _tmp17_;
		GdkPixbuf* _tmp18_;
		gint _tmp19_;
		_tmp17_ = y;
		_tmp18_ = self->close_img;
		_tmp19_ = gdk_pixbuf_get_height (_tmp18_);
		_tmp6_ = _tmp17_ < ((_tmp19_ + (GRANITE_WIDGETS_DECORATED_WINDOW_SHADOW_BLUR / 2)) + GRANITE_WIDGETS_DECORATED_WINDOW_CLOSE_BUTTON_Y);
	} else {
		_tmp6_ = FALSE;
	}
	result = _tmp6_;
	return result;
}


static gboolean granite_widgets_decorated_window_on_delete_event (GraniteWidgetsDecoratedWindow* self, GdkEventAny* event) {
	gboolean result = FALSE;
	gboolean _tmp0_;
	gboolean _tmp1_;
	g_return_val_if_fail (self != NULL, FALSE);
	g_return_val_if_fail (event != NULL, FALSE);
	_tmp0_ = gtk_window_get_deletable ((GtkWindow*) self);
	_tmp1_ = _tmp0_;
	if (_tmp1_) {
		gtk_widget_destroy ((GtkWidget*) self);
	}
	result = FALSE;
	return result;
}


gboolean granite_widgets_decorated_window_get_show_title (GraniteWidgetsDecoratedWindow* self) {
	gboolean result;
	gboolean _tmp0_;
	g_return_val_if_fail (self != NULL, FALSE);
	_tmp0_ = self->priv->_show_title;
	result = _tmp0_;
	return result;
}


void granite_widgets_decorated_window_set_show_title (GraniteWidgetsDecoratedWindow* self, gboolean value) {
	g_return_if_fail (self != NULL);
	if (granite_widgets_decorated_window_get_show_title (self) != value) {
		gboolean _tmp0_;
		_tmp0_ = value;
		self->priv->_show_title = _tmp0_;
		g_object_notify ((GObject *) self, "show-title");
	}
}


GtkBox* granite_widgets_decorated_window_get_box (GraniteWidgetsDecoratedWindow* self) {
	GtkBox* result;
	GtkBox* _tmp0_;
	g_return_val_if_fail (self != NULL, NULL);
	_tmp0_ = self->priv->_box;
	result = _tmp0_;
	return result;
}


static gpointer _g_object_ref0 (gpointer self) {
	return self ? g_object_ref (self) : NULL;
}


static void granite_widgets_decorated_window_set_box (GraniteWidgetsDecoratedWindow* self, GtkBox* value) {
	g_return_if_fail (self != NULL);
	if (granite_widgets_decorated_window_get_box (self) != value) {
		GtkBox* _tmp0_;
		GtkBox* _tmp1_;
		_tmp0_ = value;
		_tmp1_ = _g_object_ref0 (_tmp0_);
		_g_object_unref0 (self->priv->_box);
		self->priv->_box = _tmp1_;
		g_object_notify ((GObject *) self, "box");
	}
}


GtkWindow* granite_widgets_decorated_window_get_draw_ref (GraniteWidgetsDecoratedWindow* self) {
	GtkWindow* result;
	GtkWindow* _tmp0_;
	g_return_val_if_fail (self != NULL, NULL);
	_tmp0_ = self->priv->_draw_ref;
	result = _tmp0_;
	return result;
}


static void granite_widgets_decorated_window_set_draw_ref (GraniteWidgetsDecoratedWindow* self, GtkWindow* value) {
	g_return_if_fail (self != NULL);
	if (granite_widgets_decorated_window_get_draw_ref (self) != value) {
		GtkWindow* _tmp0_;
		GtkWindow* _tmp1_;
		_tmp0_ = value;
		_tmp1_ = _g_object_ref0 (_tmp0_);
		_g_object_unref0 (self->priv->_draw_ref);
		self->priv->_draw_ref = _tmp1_;
		g_object_notify ((GObject *) self, "draw-ref");
	}
}


static void granite_widgets_decorated_window_class_init (GraniteWidgetsDecoratedWindowClass * klass) {
	granite_widgets_decorated_window_parent_class = g_type_class_peek_parent (klass);
	g_type_class_add_private (klass, sizeof (GraniteWidgetsDecoratedWindowPrivate));
	((GtkWidgetClass *) klass)->button_press_event = (gboolean (*) (GtkWidget *, GdkEventButton*)) granite_widgets_decorated_window_real_button_press_event;
	((GtkWidgetClass *) klass)->button_release_event = (gboolean (*) (GtkWidget *, GdkEventButton*)) granite_widgets_decorated_window_real_button_release_event;
	((GtkWidgetClass *) klass)->key_press_event = (gboolean (*) (GtkWidget *, GdkEventKey*)) granite_widgets_decorated_window_real_key_press_event;
	G_OBJECT_CLASS (klass)->get_property = _vala_granite_widgets_decorated_window_get_property;
	G_OBJECT_CLASS (klass)->set_property = _vala_granite_widgets_decorated_window_set_property;
	G_OBJECT_CLASS (klass)->finalize = granite_widgets_decorated_window_finalize;
	/**
	         * Whether to show the window title
	         */
	g_object_class_install_property (G_OBJECT_CLASS (klass), GRANITE_WIDGETS_DECORATED_WINDOW_SHOW_TITLE_PROPERTY, g_param_spec_boolean ("show-title", "show-title", "show-title", TRUE, G_PARAM_STATIC_NAME | G_PARAM_STATIC_NICK | G_PARAM_STATIC_BLURB | G_PARAM_READABLE | G_PARAM_WRITABLE));
	g_object_class_install_property (G_OBJECT_CLASS (klass), GRANITE_WIDGETS_DECORATED_WINDOW_BOX_PROPERTY, g_param_spec_object ("box", "box", "box", gtk_box_get_type (), G_PARAM_STATIC_NAME | G_PARAM_STATIC_NICK | G_PARAM_STATIC_BLURB | G_PARAM_READABLE));
	g_object_class_install_property (G_OBJECT_CLASS (klass), GRANITE_WIDGETS_DECORATED_WINDOW_DRAW_REF_PROPERTY, g_param_spec_object ("draw-ref", "draw-ref", "draw-ref", gtk_window_get_type (), G_PARAM_STATIC_NAME | G_PARAM_STATIC_NICK | G_PARAM_STATIC_BLURB | G_PARAM_READABLE));
}


static void granite_widgets_decorated_window_instance_init (GraniteWidgetsDecoratedWindow * self) {
	self->priv = GRANITE_WIDGETS_DECORATED_WINDOW_GET_PRIVATE (self);
	self->priv->_show_title = TRUE;
	self->priv->w = -1;
	self->priv->h = -1;
}


static void granite_widgets_decorated_window_finalize (GObject * obj) {
	GraniteWidgetsDecoratedWindow * self;
	self = G_TYPE_CHECK_INSTANCE_CAST (obj, GRANITE_WIDGETS_TYPE_DECORATED_WINDOW, GraniteWidgetsDecoratedWindow);
	_g_object_unref0 (self->priv->_box);
	_g_object_unref0 (self->priv->_draw_ref);
	_g_object_unref0 (self->close_img);
	_g_object_unref0 (self->priv->buffer);
	_g_object_unref0 (self->priv->_title);
	G_OBJECT_CLASS (granite_widgets_decorated_window_parent_class)->finalize (obj);
}


/**
     * This class is a standard decorated window.
     */
GType granite_widgets_decorated_window_get_type (void) {
	static volatile gsize granite_widgets_decorated_window_type_id__volatile = 0;
	if (g_once_init_enter (&granite_widgets_decorated_window_type_id__volatile)) {
		static const GTypeInfo g_define_type_info = { sizeof (GraniteWidgetsDecoratedWindowClass), (GBaseInitFunc) NULL, (GBaseFinalizeFunc) NULL, (GClassInitFunc) granite_widgets_decorated_window_class_init, (GClassFinalizeFunc) NULL, NULL, sizeof (GraniteWidgetsDecoratedWindow), 0, (GInstanceInitFunc) granite_widgets_decorated_window_instance_init, NULL };
		GType granite_widgets_decorated_window_type_id;
		granite_widgets_decorated_window_type_id = g_type_register_static (GRANITE_WIDGETS_TYPE_COMPOSITED_WINDOW, "GraniteWidgetsDecoratedWindow", &g_define_type_info, 0);
		g_once_init_leave (&granite_widgets_decorated_window_type_id__volatile, granite_widgets_decorated_window_type_id);
	}
	return granite_widgets_decorated_window_type_id__volatile;
}


static void _vala_granite_widgets_decorated_window_get_property (GObject * object, guint property_id, GValue * value, GParamSpec * pspec) {
	GraniteWidgetsDecoratedWindow * self;
	self = G_TYPE_CHECK_INSTANCE_CAST (object, GRANITE_WIDGETS_TYPE_DECORATED_WINDOW, GraniteWidgetsDecoratedWindow);
	switch (property_id) {
		case GRANITE_WIDGETS_DECORATED_WINDOW_SHOW_TITLE_PROPERTY:
		g_value_set_boolean (value, granite_widgets_decorated_window_get_show_title (self));
		break;
		case GRANITE_WIDGETS_DECORATED_WINDOW_BOX_PROPERTY:
		g_value_set_object (value, granite_widgets_decorated_window_get_box (self));
		break;
		case GRANITE_WIDGETS_DECORATED_WINDOW_DRAW_REF_PROPERTY:
		g_value_set_object (value, granite_widgets_decorated_window_get_draw_ref (self));
		break;
		default:
		G_OBJECT_WARN_INVALID_PROPERTY_ID (object, property_id, pspec);
		break;
	}
}


static void _vala_granite_widgets_decorated_window_set_property (GObject * object, guint property_id, const GValue * value, GParamSpec * pspec) {
	GraniteWidgetsDecoratedWindow * self;
	self = G_TYPE_CHECK_INSTANCE_CAST (object, GRANITE_WIDGETS_TYPE_DECORATED_WINDOW, GraniteWidgetsDecoratedWindow);
	switch (property_id) {
		case GRANITE_WIDGETS_DECORATED_WINDOW_SHOW_TITLE_PROPERTY:
		granite_widgets_decorated_window_set_show_title (self, g_value_get_boolean (value));
		break;
		case GRANITE_WIDGETS_DECORATED_WINDOW_BOX_PROPERTY:
		granite_widgets_decorated_window_set_box (self, g_value_get_object (value));
		break;
		case GRANITE_WIDGETS_DECORATED_WINDOW_DRAW_REF_PROPERTY:
		granite_widgets_decorated_window_set_draw_ref (self, g_value_get_object (value));
		break;
		default:
		G_OBJECT_WARN_INVALID_PROPERTY_ID (object, property_id, pspec);
		break;
	}
}



